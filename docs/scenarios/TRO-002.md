# TRO-002: Kiosk Breakout Simulation

- **ID:** TRO-002
- **Category:** Execution Simulation / USB HID Emulation
- **MITRE ATT&CK Mapping:** [T1566 - Phishing (Physical Delivery Aspect)](https://attack.mitre.org/techniques/T1566/) / [T1201 - Password Policy Discovery (Escape)](https://attack.mitre.org/techniques/T1201/)

---

## ðŸ“– Description

This scenario researches the common configuration weaknesses of public kiosks or locked-down corporate terminals. The Teensy emulates a keyboard that attempts a series of known Windows/Linux hotkey "escape" sequences (Alt+Tab, Win+R, Ctrl+Shift+Esc, etc.) to identify if the shell can be bypassed and a command prompt/explorer instance accessed.

## ðŸŽ¯ Attack Objective

Verify the effectiveness of kiosk mode software or GPO-based lockdowns against automated "hotkey spray" attacks.

## ðŸ‘¥ Threat Model

- **Opportunistic Adversary:** A user at a public terminal (airport, library, lobby) attempting to gain deeper access to the underlying OS.
- **Physical Penetration Tester:** Assessing the security of dedicated-use hardware (e.g., ATM, ticketing machine).

## ðŸ› ï¸ Requirements

- **Hardware:** Teensy 4.x
- **OS Environment:** Windows 10/11 or Ubuntu (Kiosk configurations)
- **Prerequisites:** Physical USB access to the kiosk.

---

## ðŸ”„ High-Level Flow

1. **Device Insertion:** Teensy insertion.
2. **Phase 1: Surface Discovery:** Teensy tries non-destructive keys like `Win+D` to minimize all windows.
3. **Phase 2: ESC/Alt+F4:** Tries to close the foreground application.
4. **Phase 3: Administrative Triggers:** Tries `Ctrl+Shift+Esc` (Task Manager) or `Win+X` (Quick Link menu).
5. **Phase 4: Verification:** If a window opens, it attempts to type a simple `whoami` command to check if execution is possible.

---

## ðŸ“ˆ Detection Surface

### Host-Level Logs

- **Process Creation:** If a "breakout" is successful, logs will show the launch of `cmd.exe`, `powershell.exe`, or `taskmgr.exe`.
- **GPO Violations:** If "Prohibited Apps" are attempted, Windows may log blocks (AppLocker/Policy).

### Behavioral Guidance

- **Rapid Keys:** Multiple "High-Privilege" hotkeys (like Ctrl+Shift+Esc) pressed within milliseconds of each other.
- **UI Focus Changes:** Rapid switching between windows (`Alt+Tab`) initiated programmatically.

---

## ðŸ›¡ï¸ Mitigation & Controls

- **Shell Replacement:** Use a custom shell instead of `explorer.exe` for the kiosk user.
- **GPO Lockdown:** Disable specific hotkeys via the `NoWinKeys` registry setting or specialized Kiosk software.
- **Physical Security:** Enclose USB ports or use specialized "Port Blockers" to prevent unauthorized device insertion.

---

## âš–ï¸ Legal & Ethical Notice
>
> [!IMPORTANT]
> This simulation is for auditing kiosk software only. Unauthorized use on public terminals is strictly prohibited.

---

**Author:** Ismail Tasdelen
**Updated:** 2026-01-01
