# TRO-003: Credential Hunter (UI-Based)

- **ID:** TRO-003
- **Category:** Credential Interaction Scenarios
- **MITRE ATT&CK Mapping:** [T1056.002 - Input Capture: GUI Input Capture](https://attack.mitre.org/techniques/T1056/002/)

---

## ðŸ“– Description

This scenario demonstrates how hardware-driven HID interactions can assist in credential harvesting. The Teensy triggers a PowerShell script that pops a standard Windows credential prompt (`Get-Credential`). Once the user enters their information, the simulation "types" the captured username back into a harmless notepad window to demonstrate successful exfiltration of the data via the HID channel (emulating a keyboard).

## ðŸŽ¯ Attack Objective

Educate users and security teams on the dangers of "Random Popups" and UI-based spoofing, showing how hardware can bridge the gap between software execution and data exfiltration.

## ðŸ‘¥ Threat Model

- **Social Engineering:** An attacker tricks a target into plugging in the device "to check a file," which then triggers the prompt.
- **Physical Access:** Triggering the prompt while a user is away, hoping they sign back in and blindly fill the prompt.

## ðŸ› ï¸ Requirements

- **Hardware:** Teensy 4.x
- **OS Environment:** Windows 10/11
- **Prerequisites:** Powershell enabled on the host.

---

## ðŸ”„ High-Level Flow

1. **Trigger:** HID sequence opens PowerShell.
2. **Payload:** Executes a command to pop `Get-Credential`.
3. **User Action:** User (victim) enters credentials.
4. **Capture:** The script stores the credentials in a variable.
5. **Simulated Exfiltration:** The script opens `notepad.exe` and the Teensy "reads" the captured data (in a real attack, it would be exfiltrated differently, but here we type it out for visibility).

---

## ðŸ“ˆ Detection Surface

### Host-Level Logs

- **Sysmon Event ID 1:** PowerShell spawning with `Get-Credential` in the command line.
- **PowerShell Script Block Logging:** Recording the capture logic.

### Behavioral Indicators

- **Unexpected Credential Prompts:** Prompts appearing without a clear user-initiated cause (e.g., not during a login or admin task).

---

## ðŸ›¡ï¸ Mitigation & Controls

- **User Education:** Teach users to never enter credentials into a prompt they did not expect.
- **Code Signing:** Enforce PowerShell script signing to prevent unauthorized scripts from running.
- **EWA (Enhanced Windows Auditing):** Monitor for specific API calls related to credential prompts.

---

## âš–ï¸ Legal & Ethical Notice
>
> [!IMPORTANT]
> This payload is for visualization of the threat only. It DOES NOT send credentials to any external server.

---

**Author:** Ismail Tasdelen
**Updated:** 2026-01-01
